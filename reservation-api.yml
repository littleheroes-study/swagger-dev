openapi: "3.0.3"

info:
  title: "美容室予約"
  description: |
    # 説明
    * 美容室の予約、確認を行うAPI
    # 機能
    - Reservations 一覧取得
    - Reservations 登録
    - Reservations 取得
    - Reservations 更新
    - Reservations 削除
  version: "1.0.0"

tags:
  - name: reservation
    description: "予約機能"

paths:
  /reservations:
    get:
      operationId: getReservations
      summary: "Reservations 一覧取得"
      tags: [reservation]
      description: "予約一覧を取得する"
      responses:
        "200":
          description: "Success"
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ReservationInfo"
        "400":
          $ref: "#/components/responses/400-BadRequest"
        "403":
          $ref: "#/components/responses/403-Forbidden"
        "500":
          $ref: "#/components/responses/500-InternalServerError"
    post:
      operationId: postReservations
      summary: "Reservations 登録"
      tags: [reservation]
      description: "予約を登録する"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservationInfo"
      responses:
        "200":
          description: "登録成功"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ReservationInfo"
        "422":
          $ref: "#/components/responses/422-UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500-InternalServerError"

  /reservations/{reservationId}:
    get:
      operationId: getReservation
      summary: "Reservations 取得"
      tags: [reservation]
      description: "予約情報を取得する"
      parameters:
        - in: path
          name: reservation_id
          schema:
            type: string
          required: true
      responses:
        "200":
          description: "Success"
          content:
            application/json:
              schema:
                type: object
                $ref: "#/components/schemas/ReservationInfo"
        "400":
          $ref: "#/components/responses/400-BadRequest"
        "403":
          $ref: "#/components/responses/403-Forbidden"
        "500":
          $ref: "#/components/responses/500-InternalServerError"

    put:
      operationId: putReservation
      summary: "Reservations 更新"
      tags:
        - reservation
      description: "予約情報を更新する"
      parameters:
        - in: path
          name: reservation_id
          schema:
            type: string
          required: true
      requestBody: 
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservationInfo"
      responses: 
        "200":
          description: "Success"
          content:
            application/json:
              schema:
                type: object
                $ref: "#/components/schemas/ReservationInfo"
        "422":
          $ref: "#/components/responses/422-UnprocessableEntity"
        "500":
          $ref: "#/components/responses/500-InternalServerError"

    delete:
      operationId: deleteReservation
      summary: "Reservations 削除"
      description: "予約情報を削除する"
      tags:
        - reservation
      parameters:
        - in: path
          name: reservation_id
          schema:
            type: string
          required: true
      responses:
        "204":
          description: "削除成功"
        "500":
          $ref: "#/components/responses/500-InternalServerError"

components:
  schemas:
    ReservationInfo:
      type: object
      properties:
        hair_salon:
          description: "店舗名"
          type: string
        hairdresser:
          description: "美容師"
          type: string
        reservation_id:
          description: "予約ID"
          type: string
        reservation_date_time:
          description: "予約日時"
          type: string
          format: date-time
          example: "YYYY/MM/DD"

  responses:
    400-BadRequest:
      description: "Bad Request"
      content:
        application/json:
          schema:
            type: object
            properties:
              message: { type: string, example: "Bad Request" }
            required:
              - message
    403-Forbidden:
      description: "Forbidden"
      content:
        application/json:
          schema:
            type: object
            properties:
              message: { type: string, example: "Forbidden" }
            required:
              - message
    422-UnprocessableEntity:
      description: "Unprocessable Entity"
      content:
        application/json:
          schema:
            type: object
            properties:
              message: { type: string, example: "Unprocessable Entity" }
              errors:
                type: object
                properties:
                  string:
                    type: array
                    items:
                      type: string
                      example: "hairdresser required"
    500-InternalServerError:
      description: "Internal Server Error"
      content:
        application/json:
          schema:
            type: object
            properties:
              message: { type: string, example: "Internal Server Error" }
            required:
              - message

